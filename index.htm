<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Akash DataCare</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
<style>
  body { background: linear-gradient(135deg,#0f2027,#203a43,#2c5364); color:#fff; font-family:Poppins, sans-serif; min-height:100vh;}
  .assistant-box{max-width:540px;margin:60px auto;padding:28px;border-radius:18px;background:rgba(255,255,255,0.04);box-shadow:0 8px 30px rgba(0,0,0,0.5);backdrop-filter:blur(8px)}
  .mic-btn{width:86px;height:86px;border-radius:50%;background:#4caf50;border:none;box-shadow:0 0 18px rgba(76,175,80,0.6)}
  .wave{width:12px;height:40px;background:#00eaff;margin:0 4px;border-radius:6px;animation:wave 1s infinite}
  @keyframes wave{0%{height:10px}50%{height:40px}100%{height:10px}}
  #output{min-height:120px;background:rgba(0,0,0,0.35);padding:14px;border-radius:10px;overflow:auto}
</style>
</head>
<body>
  <div class="assistant-box text-center">
    <h2 class="fw-bold mb-2">üõ°Ô∏è Akash DataCare</h2>
    <p class="mb-3 text-light">Data management me help ke liye mic dabao ya boliye.</p>

    <div class="d-flex justify-content-center mb-3">
      <div class="wave"></div>
      <div class="wave" style="animation-delay:0.08s"></div>
      <div class="wave" style="animation-delay:0.16s"></div>
      <div class="wave" style="animation-delay:0.24s"></div>
    </div>

    <button class="mic-btn mb-3" id="micBtn"><i class="fa-solid fa-microphone fa-2x text-white"></i></button>

    <div id="output" class="text-start"><strong>Assistant:</strong> Loading‚Ä¶</div>
  </div>

<script>
/* ---------------- Option 1 JSON Prompt (inline) ---------------- */
const dataCarePrompt = {
  role: "system",
  content: "You are Akash DataCare, a real-time Voice + Text AI Assistant focused on data management. Speak friendly Hinglish, give short, clear, accurate responses. Expertise in Google Sheets formulas, Excel, data cleaning, validation, dashboards, ETL logic. Don't guess, don't be robotic, always help efficiently."
};
/* --------------------------------------------------------------- */

const outputBox = document.getElementById('output');
const PROXY_URL = "https://REPLACE_WITH_YOUR_PROXY_ENDPOINT"; // ‚Üê Replace after backend deploy

// Speech recognition
const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
const recognition = new SpeechRecognition();
recognition.lang = "hi-IN";

// Auto welcome
window.onload = () => {
  const welcomeText = "Namaste! Main Akash DataCare hoon, aapka data management assistant. Bataiye, kaise help kar sakta hoon?";
  speak(welcomeText);
  outputBox.innerHTML = "<strong>Assistant:</strong> " + welcomeText;
};

// Mic click
document.getElementById('micBtn').addEventListener('click', () => {
  recognition.start();
  outputBox.innerHTML = "<strong>Listening...</strong>";
});

recognition.onresult = async (ev) => {
  const userText = ev.results[0][0].transcript;
  outputBox.innerHTML = "<strong>You:</strong> " + userText + "<br><br><strong>Assistant:</strong> Soch raha hoon...";

  const reply = await getAIResponse(userText);
  outputBox.innerHTML = "<strong>You:</strong> " + userText + "<br><br><strong>Assistant:</strong> " + reply;
  speak(reply);
};

function speak(text){
  const s = new SpeechSynthesisUtterance(text);
  s.lang = "hi-IN";
  s.rate = 1;
  s.pitch = 1;
  window.speechSynthesis.speak(s);
}

/* ---------------- getAIResponse -> calls your secure proxy ---------------- */
async function getAIResponse(userText){
  if(!PROXY_URL || PROXY_URL.includes("REPLACE_WITH")) {
    // Demo/dummy fallback
    return "Theek hai! Aapke data ke liye best solution soch raha hoon.";
  }

  try {
    const resp = await fetch(PROXY_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        prompt: [ dataCarePrompt, { role: "user", content: userText } ]
      })
    });
    const data = await resp.json();
    // Adjust according to your proxy response shape
    return data.reply || data.output || JSON.stringify(data).slice(0,300);
  } catch(err) {
    console.error(err);
    return "Maaf kijiyega ‚Äî server se connect nahi kar pa raha hoon.";
  }
}
</script>
</body>
</html>
